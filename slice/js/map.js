function initialize(){geocoder=new google.maps.Geocoder}var Marker,map,markerCounter=0,flightPlanCoordinates=[],myPos={lat:-34.397,lng:150.644},markeArr=[],LinePathArr=[],service,geocoder,CityName=[],infowindow,nameCounter=0,name,geocoder,city;initMap=function(){map=new google.maps.Map(document.getElementById("map"),{center:myPos,zoom:4,styles:[]})},initMarker=function(e,a){var n=new google.maps.LatLng(e,a);geocoder.geocode({latLng:n},function(n,t){if(t==google.maps.GeocoderStatus.OK)if(console.log(n[0].formatted_address.split(",")[n[0].formatted_address.split(",").length-1]),n[1]){name=n[0].formatted_address;for(var o=0;o<n[0].address_components.length;o++)for(var r=0;r<n[0].address_components[o].types.length;r++)if("administrative_area_level_1"==n[0].address_components[o].types[r]){city=n[0].address_components[o];break}name=city.short_name+" "+city.long_name;var i={lat:e,lng:a},l="images/marker.png";Marker=new google.maps.Marker({position:i,draggable:!0,map:map,icon:l}),markeArr.push(Marker),infowindow=new google.maps.InfoWindow({content:name}),infowindow.open(map,Marker),google.maps.event.addListener(Marker,"dragend",function(e){var a,n;flightPathClean();for(var t=0;t<markeArr.length;t++)a=markeArr[t].position.lat(),n=markeArr[t].position.lng(),flightPath(a,n)})}else alert("No results found");else alert("Geocoder failed due to: "+t)})},MapClick=function(){var e;google.maps.event.addListener(map,"click",function(a){e=a.latLng.lat(),lng=a.latLng.lng(),chengeMarkerCoordinate(e,lng)})},chengeMarkerCoordinate=function(e,a){initMarker(e,a),flightPath(e,a)},flightPathClean=function(){flightPlanCoordinates=[];for(var e=0;e<LinePathArr.length;e++)LinePathArr[e].setMap(null)},flightPath=function(e,a){element={},element.lat=e,element.lng=a,flightPlanCoordinates.push(element),markeArr.length>1&&(LinePath=new google.maps.Polyline({path:flightPlanCoordinates,geodesic:!0,strokeColor:"#fff ",strokeOpacity:1,strokeWeight:2}),LinePathArr.push(LinePath),LinePath.setMap(map))},TaskManager=function(){initMap(),MapClick(),initialize()},$(document).ready(function(){TaskManager()});